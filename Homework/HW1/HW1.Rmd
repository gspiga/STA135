---
title: "HW1 - STA 135"
author: "Gianni Spiga"
date: "3/29/2022"
output: html_document
---



## Problem 1.6
### a.)
```{r}
airpol <-
  read.csv("~/GitHub/STA135/Homework/HW1/Air-Pollution Data G.C.Tao.csv",
           header = TRUE)
library(ggplot2)
library(ggExtra)
library(GGally)

#Pairwise plots
ggpairs(airpol)
```
```{r}
#Marginal plots
colnames <- names(airpol)
for (i in colnames[-1]){
  print(ggMarginal(ggplot(airpol, aes_string(x = "Wind..x1.", y = i)) + geom_point(color = 'firebrick'), type = 'histogram', fill = 'dodgerblue'))
}

```
### b.)
```{r}
#xbar, mean vector
colMeans(airpol[sapply(airpol, is.numeric)]) 

#Sn, the COV/VAR marix
n = nrow(airpol)
cov(airpol) * (n-1)/n

# R the correlation matrix
round(cor(airpol),2)
```
We can see that none of the variables have a very high correlation. We can see the highest correlation in our data is between Carbon Monoxide (CO) and Nitrogen Dioxide (NO2) of 0.557. We also can see that Wind is negatively correlated with all pollutants. 


## Problem 1.9

```{r}
#a.)
library(plotly)
x1 <- c(-6, -3, -2, 1, 2, 5, 6, 8)
x2 <- c(-2, -3, 1, -1, 2, 1, 5, 3)
mydata <- data.frame(x1, x2)

#ggplot(aes(x = x1, y = x2)) + geom_point()
fig <- plot_ly(mydata, x = ~x1, y = ~x2)
fig

n = nrow(mydata)
myvarmat = cov(mydata) * (n-1)/n
myvarmat
s11 = myvarmat[1]
s12 = myvarmat[2]
s22 = myvarmat[4]
```


```{r}
#b.) 
#Formula pdf page 56

# x1~ = x1 costheta + x2 sintheta
x1tilde = x1 * 0.899 + x2 * 0.438

# x2~ = -x1 sintheta + x2 costheta
x2tilde = -x1 * 0.438 + x2 * 0.899

#c 
datatilde = data.frame(x1tilde, x2tilde)
n = nrow(datatilde)
diag(var(datatilde))  #* (n-1)/n)

#d
newx1 = 4 * 0.899 + -2 * 0.438
newx2 = -4 * 0.438 + -2 * 0.899

dOP = sqrt((newx1^2/28.462) + (newx2^2/2.022))
dOP

#e
#From footnote
a11 = (0.899^2/(0.899^2 * s11 + 2 * 0.438 * 0.899 * s12 + 0.438^2 * s22)) + (0.438^2/ (0.899^2 * s22 - 2 * 0.438 * 0.899 * s12 + 0.438^2 * s11))

a22 = (0.438^2 / (0.899^2 * s11 + 2 * 0.438 * 0.899 *s12 + 0.438^2 * s22)) + (0.899^2 / (0.899^2 * s22 - 2 * 0.438 * 0.899*s12 + 0.438^2 * s11))

a12 = ((0.438 * 0.899) / (0.899^2 * s11 + 2 * 0.438 * 0.899 * s12 + 0.438^2 * s22)) - ((0.438 * 0.899)/ (0.899^2 * s22 - 2 * 0.438 * 0.899 * s12 + 0.438^2 * s11))

dOP2 = sqrt((a11 * 16) + (2*a12 * 4 * -2) + (a22 * 4))
dOP2
```
We can see that within rounding error, these two distances are about the same. 

## P 1.18
```{r}
WomenTrack <- read.csv("~/Github/STA135/Homework/HW1/National Track Records for Women.csv", header =  TRUE)
#WomenTrack

#First, convert last 4 columns into seconds 
WomenTrack[,5:8] = WomenTrack[, 5:8] * 60
#WomenTrack

#Second, divide each column by respective meters to get meters per second
meters = c(1, 100, 200, 400, 800, 1500, 3000, 42195)
for (i in 2:length(meters)){
  WomenTrack[,i] <- meters[i]/ WomenTrack[,i]
}
WomenTrack

#mean vector
colMeans(WomenTrack[sapply(WomenTrack, is.numeric)])

#Sigma
n = nrow(WomenTrack)
cov(WomenTrack[,-1]) * (n-1/n)

#R
cor(WomenTrack[,-1])
```
We can see that as a runner travels more distance, the correlation between their 100m other distances decreases. However, the correlation with their marathon rate increases. 

#Problem 2.2
```{r}
A = matrix(c(-1, 3, 4, 2),
           nrow = 2,
           ncol = 2,
           byrow = TRUE)
B = matrix(c(4, -3, 1, -2,-2, 0),
           nrow = 3,
           ncol = 2,
           byrow = TRUE)
C = matrix(c(5,-4, 2), nrow = 3, ncol = 1)

#a.)
5 * A
#b.)
B %*% A
#c.)
t(A) %*% t(B)
#d.)
t(C) %*% B
#e.) #Produces an error, non-conformable arguments
# Dimensions for these matricies are not aligned
# A %*% B
```
## P 2.3
```{r}
A = matrix(c(2, 1, 1, 3),
           nrow = 2,
           ncol = 2,
           byrow = TRUE)
B = matrix(c(1, 4, 2, 5, 0, 3),
           nrow = 2,
           ncol = 3,
           byrow = TRUE)
C = matrix(c(1, 4, 3, 2),
           nrow = 2,
           ncol = 2,
           byrow = TRUE)

#a.)
all.equal(A, t(A))
#b.)
all.equal(solve(t(C)), t(solve(C)))
#c.)
all.equal(t(A %*% B), t(B) %*% t(A))

```
e.)
Let's first show that:

$$
(AB)^T_{ij} = (AB)_{ji} = \sum^n_{k=1}A_{jk}B_{ki} 
$$

Next we show that:
$$
(B^TA^T)_{ij}= \sum\limits_{k=1}^nB^T_{ik}A^T_{kj}= \sum\limits_{k=1}^nB_{ki}A_{jk}= \sum\limits_{k=1}^nA_{jk}B_{ki}
$$

Since we can see that both sides of the equation $(AB)_{ji} = (AB)^T_{ij}$ equal the same summation. We can conclude that in the general case the transpose of the product of $A$ and $B$ is equal to the product of $A^T$ and $B^T$. 

## P 2.4
a.)
$$\begin{aligned}
(A^{-1})^T &= (A^{-1})^TA^T(A^T)^{-1} \\
 &=(AA^{-1})^T(A^T)^{-1} \\
&=I^T(A^T)^{-1} \\
&= (A^T)^{-1} \\
\end{aligned}
$$

b.)
$$\begin{aligned}
(AB)^{-1} &= B^{-1}A^{-1} \\
&= B^{-1}A^{-1}(AB)(AB)^{-1}\\
&= B^{-1}(A^{-1}A)B(AB)^{-1} \\
&= I(AB)^{-1}\\
&= (AB)^{-1}
\end{aligned}
$$
## Problem 5
$$
A = \begin{pmatrix}
1 & 2 \\
2 & -2 \\
\end{pmatrix}\\
$$
To find eigenvaules we solve: 
$$\begin{aligned}
|A - \lambda * I| &= 0\\
det(\begin{pmatrix}
1 & 2 \\
2 & -2 \\
\end{pmatrix} - \begin{pmatrix}
\lambda & 0 \\
0 & \lambda \\
\end{pmatrix} &= \\
det(\begin{pmatrix}
1 - \lambda & 2 \\
2 & -2 - \lambda \\
\end{pmatrix}) &= \\
-2 - \lambda + 2\lambda + \lambda^2 - 4 &= \\
\lambda^2 + \lambda - 6 &= \\ 
(\lambda + 3)(\lambda - 2) &= \\
\lambda_1 = -3, \lambda_2 = 2
\end{aligned}
$$
Now we find the eigenvectors. Here is the first eigenvalue, -3. 

\begin{aligned}
Av &= \lambda_1v\\
(A - \lambda_1)v &= 0 \\
(A + 3)v &= 0 \\
\begin{pmatrix}
4 & 2 \\
2 & 1 \\
\end{pmatrix} v &= 0\\
\begin{pmatrix}
4 & 2 \\
2 & 1 \\
\end{pmatrix} \begin{pmatrix}
v_1 \\
v_2 \\
\end{pmatrix} &= 0\\

4v_1 + 2v_2 &= 0\\
2v_1 + v_2 &= 0 \\

v_1 = k \begin{pmatrix}
1/2 \\
1 \\
\end{pmatrix}
\end{aligned}


Now the second eigenvector with the eigenvalue 2. 
\begin{aligned}
Av &= \lambda_1v\\
(A - \lambda_2)v &= 0 \\
(A- 2)v &= 0 \\
\begin{pmatrix}
-1 & 2 \\
2 & -4 \\
\end{pmatrix} v &= 0\\
\begin{pmatrix}
-1 & 2 \\
2 & -4 \\
\end{pmatrix} \begin{pmatrix}
v_1 \\
v_2 \\
\end{pmatrix} &= 0\\

-1v_1 + 2v_2 &= 0\\
2v_1 + -4v_2 &= 0 \\

v_2 = k \begin{pmatrix}
2 \\
1 \\
\end{pmatrix}
\end{aligned}


First we normalize the vectors
\begin{aligned}
v_1 &= \begin{pmatrix}
1/2 \\
1 \\
\end{pmatrix}\\
||v_1|| &= \sqrt{5}/4 \\ 
\hat{v_1} &= \begin{pmatrix}
8/\sqrt{5}\\
4/\sqrt{5}\\
\end{pmatrix}\\
\\

v_2 = \begin{pmatrix}
2 \\
1 \\
\end{pmatrix}\\

||v_2|| &= \sqrt{5}\\
\hat{v_2} &= \begin{pmatrix}
2/\sqrt{5}\\
1/\sqrt{5}\\
\end{pmatrix}
\end{aligned}


The spectral decomposition thus is 

\begin{aligned}
2 \begin{pmatrix}
8/\sqrt{5}\\
4/\sqrt{5}\\
\end{pmatrix} \begin{pmatrix}
8/\sqrt{5} & 4/\sqrt{5}\\
\end{pmatrix} - 3 \begin{pmatrix}
8/\sqrt{5}\\
4/\sqrt{5}\\
\end{pmatrix} \begin{pmatrix}
2/\sqrt{5} & 1/\sqrt{5}\\
\end{pmatrix}
\end{aligned}



## Problem 6
P 2.11

See by hand

P 2.12

## Problem 7
P 2.30

## Problem 8
P 2. 34
```{r}
b <- matrix(c(2, -1, 4,0), nrow= 4, ncol = 1)
d <- matrix(c(-1,3,-2,1), nrow= 4, ncol = 1)

LHS <- as.numeric((t(b) %*% d)^2)
RHS <- as.numeric((t(b) %*% b) %*% (t(d) %*% d))
LHS > RHS
 ```