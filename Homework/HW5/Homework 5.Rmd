---
title: "Homework 5"
author: "Gianni Spiga"
date: "5/21/2022"
output: html_document
---

## P1 
8.1.) 

```{r}
Sigma <- matrix(c(5, 2, 2, 2), nrow = 2, ncol = 2 )
Sigma

eigSigma = eigen(Sigma)
eigSigma$values
eigSigma$vectors
```

The population principal components are:
$$
Y_1 = -0.8944X_1 + 0.4472X_2\\
Y_2 = -0.4472X_1 - 0.8944X_2\\

$$
The proportion of total variance explained by $Y_1$ is:
```{r}
eigSigma$values[1] / sum(eigSigma$values)
```
8.2.)
a.)
```{r}
D = diag(sqrt(diag(Sigma)))
D
corr = solve(D) %*% Sigma %*% solve(D)
corr
eigCorr = eigen(corr)
eigCorr$values
eigCorr$vectors
```
The population principal components are:
$$
Y_1 = -0.7071X_1 + 0.7071X_2\\
Y_2 = -0.7071X_1 - 0.7071X_2\\
$$
The proportion of total variance explained by $Y_1$ is:
```{r}
eigCorr$values[1] / sum(eigCorr$values)
```
b.)
As we can see above, the estiamtes are not the same. When we standardize our variables, the eigenvectors become identical. Since we have now controlled each eigenvector to have the same mean and variance, they contribute equally, unlike before. 
c.)
```{r}
#PDF Pg 460
rho1 <- eigCorr$vectors[1,1] * sqrt(eigCorr$values[1])
rho1
rho12 <- eigCorr$vectors[1,2] * sqrt(eigCorr$values[1])
rho12
rho2 <- eigCorr$vectors[2,2] * sqrt(eigCorr$values[2])
rho2
```
## P2
8.10
a.) and b.) 
```{r}
stock <- read.table("~/GitHub/STA135/Homework/HW5/T8-4.dat")
names(stock) <- c("JP Morgan", "Citibank", "Wells Fargo", "Royal Dutch Shell", "Exxon Mobil")
stock

cov(stock)

#Using spectral decomposition instead of SVD
sum(princomp(stock)$sdev)
summary(princomp(stock))
```
As we can see from above, the cumulative proportion of variance explained by the first 3 variables is 0.899 percent. 
c.)
c.)
